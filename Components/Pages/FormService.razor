@using Microsoft.EntityFrameworkCore
@using Microsoft.AspNetCore.Components
@using PetShop.Components.Layout.UI
@using PetShop.Components.Layout.UI.Card
@namespace PetShop.Components.Pages
@inject NavigationManager Navigation

@page "/services"
@rendermode InteractiveServer

<PageTitle>FormService</PageTitle>

<main class="space-y-3">
    <section class="auto-limit-w flex flex-col px-4 gap-8 min-h-[calc(100vh-9rem)]">
        <div class="space-y-3 items-center">
            <h3 class="font-semibold text-2xl md:text-6xl text-left">
                <span class="text-primary">Book Your Pet’s Appointment</span>
            </h3>
        </div>

        <!-- Dropdown for Service Type -->
        <div class="flex flex-col gap-2">
            <label for="serviceType" class="text-lg md:text-xl font-semibold text-left">
                Book Your Service:
            </label>
            <select id="serviceType" @onchange="OnServiceChange" class="border border-gray-300 rounded-md p-2 w-full">
                <option value="vetCheckUp">Vet and Check-up</option>
                <option value="petGrooming">Pet Grooming</option>
                <option value="petSitting">Pet Sitting</option>
            </select>
        </div>

        <!-- Dropdown for Pet Type -->
        <div class="flex flex-col gap-2">
            <label for="petType" class="text-lg md:text-xl font-semibold text-left">
                Choose Your Pet Type:
            </label>
            <select id="petType" @bind="selectedPetType" class="border border-gray-300 rounded-md p-2 w-full">
                <option value="dog">Dog</option>
                <option value="cat">Cat</option>
                <option value="reptilian">Reptilian</option>
                <option value="bugs">Bug</option>
                <option value="other">Other</option>
            </select>
        </div>

        <!-- Input for Owner's Name -->
        <div class="flex flex-col gap-2">
            <label for="ownerName" class="text-lg md:text-xl font-semibold text-left">
                Owner's Name:
            </label>
            <input id="ownerName" @bind="ownerName" type="text" placeholder="Enter owner's name" class="border border-gray-300 rounded-md p-4 w-full">
        </div>
        
       <!-- Input for Owner's Phone Number -->
        <div class="flex flex-col gap-2">
            <label for="ownerPhoneNumber" class="text-lg md:text-xl font-semibold text-left">
                Owner's Phone Number:
            </label>
            <input id="ownerPhoneNumber" @bind="ownerPhoneNumber" type="text" placeholder="Enter owner's phone number" class="border border-gray-300 rounded-md p-4 w-full">
        </div>
        
        <!-- Input for Owner's Email -->
        <div class="flex flex-col gap-2">
            <label for="ownerEmail" class="text-lg md:text-xl font-semibold text-left">
                Owner's Email:
            </label>
            <input id="ownerEmail" @bind="ownerEmail" type="text" placeholder="Enter owner's email" class="border border-gray-300 rounded-md p-4 w-full">
        </div>
        
         <!-- Input for Pet's Name -->
        <div class="flex flex-col gap-2">
            <label for="petName" class="text-lg md:text-xl font-semibold text-left">
                Pet's Name:
            </label>
            <input id="petName" @bind="petName" type="text" placeholder="Enter pet's name" class="border border-gray-300 rounded-md p-4 w-full">
        </div>
        
                <!-- Input for Pet's Allergic -->
        <div class="flex flex-col gap-2">
            <label for="petAllergic" class="text-lg md:text-xl font-semibold text-left">
                Pet's Allergic:
            </label>
            <input id="petAllergic" @bind="petAllergic" type="text" placeholder="Enter pet's allergy" class="border border-gray-300 rounded-md p-4 w-full">
        </div>
        
                <!-- Date Picker Input for Choosing Date -->
        <div class="flex flex-col gap-2">
            <label for="appointmentDate" class="text-lg md:text-xl font-semibold text-left">
                Choose Date:
            </label>
            <input id="appointmentDate" @bind="appointmentDate" type="date" class="border border-gray-300 rounded-md p-4 w-full">
        </div>

        <div class="flex gap-5 justify-center">
            <Button class="border border-input bg-background">
                Cancel
            </Button>
            <Button class="bg-primary text-primary-foreground" @onclick="ProceedToConfirmation">
                Continue
            </Button>
        </div>
    </section>
</main>

@code {
    private string selectedService;
    private string selectedPetType;
    private string ownerName;
    private string ownerPhoneNumber;
    private string ownerEmail;
    private string petName;
    private string petAllergic;
    private DateTime appointmentDate;

    private void ProceedToConfirmation()
    {
        
        Navigation.NavigateTo($"/confirmationRegisterDoctor?service={selectedService}&petType={selectedPetType}&ownerName={ownerName}&ownerPhone={ownerPhoneNumber}&ownerEmail={ownerEmail}&petName={petName}&petAllergic={petAllergic}&date={appointmentDate.ToShortDateString()}");
    }
    
    // Method to handle service selection changes
    private void OnServiceChange(ChangeEventArgs e)
    {
        selectedService = e.Value.ToString(); // Capture the selected value

        if (selectedService == "vetCheckUp")
        {
            // Navigate to the FormServiceDoctor page
            Navigation.NavigateTo("/serviceDoctor");
        }
    }
}
